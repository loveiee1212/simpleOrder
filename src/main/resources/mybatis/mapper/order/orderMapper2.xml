<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.team2.simpleOrder.dao.order.IOrderDao2">

<select id="getsaoList" parameterType="order" resultType="order">
		SELECT PRO.PD_NAME, SUM(PRO.PD_PRICE) PD_PRICE, SUM(OH.OH_CNT) OH_COUNT
        FROM ORDER_AND_CREDIT OAC
        INNER JOIN ORDER_HISTORY OH
        ON OAC.OAC_NUM=OH.OAC_NUM
        INNER JOIN PRODUCT PRO
        ON OH.PD_CODE=PRO.PD_CODE
        WHERE OAC.OAC_STATUS='1' AND OAC.C_CODE=#{c_code} AND PRO.PD_STATUS='1'
        AND OAC.OAC_NUM = #{oac_num} AND OAC.BD_DATE  = #{bd_date}
        GROUP BY PRO.PD_NAME

</select>


</mapper>